def rate_limited_while